#!/bin/bash

deal(){
  # 判断格式然后使用subfinder处理变动的文件
  echo $1" "$2" "$4" "$3
  subfinder $3 -c /config/subfinder.json
}

path=/media
exclude=$EXCLUDE
if [ -z $exclude ]; then exclude="None(Use this string to avoid parameter error)"; fi
echo "排除监控条件："$exclude
inotifywait -mr --exclude "$exclude" --timefmt '%Y-%m-%d %H:%M' --format '%T "%w%f" %e' -e modify,create $path |
  while read events; do
    deal $events
  done
